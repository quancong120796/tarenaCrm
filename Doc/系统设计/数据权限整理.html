<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601967 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <meta name="content-class" content="yinxiang.markdown"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="776"/>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2020/8/2 16:00</i></td></tr>
<tr><td><b>作者：</b></td><td><i>QuanCong</i></td></tr>
</table>
</div>
<br/>

<div><span><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><div style="line-height: 160%; box-sizing: content-box;"><ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;"><li style="line-height: 160%; box-sizing: content-box; position: relative;"><a style="line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;">配置选项说明
</a></li><li style="line-height: 160%; box-sizing: content-box; position: relative;"><a style="line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;">代码中设置
</a></li></ul></div><h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">配置选项说明</h4>
<blockquote style="line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;">
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">权限编码:</strong></li>
</ul>
<blockquote style="line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;">
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8; margin-top: 0; margin-bottom: 0;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;"> 标识权限的唯一编码，不可重复 
</code></pre>
</blockquote>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">权限名称:</strong></li>
</ul>
<blockquote style="line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;">
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8; margin-top: 0; margin-bottom: 0;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">   数据权限的中文描述(方便维护与理解)
</code></pre>
</blockquote>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">模块中文名:</strong></li>
</ul>
<blockquote style="line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;">
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8; margin-top: 0; margin-bottom: 0;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">  模块英文名对应的中文描述
</code></pre>
</blockquote>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">模块英文名:</strong></li>
</ul>
<blockquote style="line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;">
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8; margin-top: 0; margin-bottom: 0;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">  该字段为代码中获取数据权限对应的参数，搭配分配的不同权限组可实现对于同一模块不同角色对应不同的数据权限
</code></pre>
</blockquote>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">权限sql:</strong></li>
</ul>
<blockquote style="line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777; margin-bottom: 0;">
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8; margin-top: 0; margin-bottom: 0;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">  最终代码中获得并拼接在sql语句后的sql语句(其中{allCenterList}等为session中存放的所有中心的id集合)  
</code></pre>
</blockquote>
</blockquote>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">代码中设置</h4>
<blockquote style="line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;">
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">作为Query对象中的参数传入</strong></li>
</ul>
<blockquote style="line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;">
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8; margin-top: 0; margin-bottom: 0;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">infoQuery.setAuthSql(MdmAuthorityUtil.getAuthSql(&quot;模块英文名&quot;));
</code></pre>
</blockquote>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">实现原理说明</strong></li>
</ul>
<blockquote style="line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777; margin-bottom: 0;">
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333; margin-top: 0;">1.查询sql(根据权限英文名和用户对应的权限组条件)</p>
<blockquote style="line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;">
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8; margin-top: 0; margin-bottom: 0;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">selectAUTH_CODE,
AUTH_NAME, AUTH_SQL, AUTH_ENG
FROM MDM_DATA_AUTH 
WHERE AUTH_STATE = 1 AND &quot;ID&quot; IN (
     SELECT AUTH_ID 
  	 FROM MDM_AUTH_PG 
  	 WHERE AUTH_ENG =#{authEng} AND
  	 AUTH_GROUP_ID IN (${permissionIds})
  	 GROUP BY auth_id ) 
</code></pre>
</blockquote>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">2.<strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">Sql拼接</strong></p>
<blockquote style="line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777; margin-bottom: 0;">
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8; margin-top: 0; margin-bottom: 0;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">将1中查询到的auth_sql拼接到查询语句的where条件中实现数据权限的控制
</code></pre>
</blockquote>
</blockquote>
</blockquote>
</div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%0A%5BTOC%5D%20%0A%23%23%23%23%20%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9%E8%AF%B4%E6%98%8E%0A%3E-%20%20%20%20**%E6%9D%83%E9%99%90%E7%BC%96%E7%A0%81%3A**%0A%3E%3E%20%20%20%20%20%20%E6%A0%87%E8%AF%86%E6%9D%83%E9%99%90%E7%9A%84%E5%94%AF%E4%B8%80%E7%BC%96%E7%A0%81%EF%BC%8C%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%20%0A%3E-%20%20%20%20**%E6%9D%83%E9%99%90%E5%90%8D%E7%A7%B0%3A**%0A%3E%3E%20%20%20%20%20%20%20%20%E6%95%B0%E6%8D%AE%E6%9D%83%E9%99%90%E7%9A%84%E4%B8%AD%E6%96%87%E6%8F%8F%E8%BF%B0(%E6%96%B9%E4%BE%BF%E7%BB%B4%E6%8A%A4%E4%B8%8E%E7%90%86%E8%A7%A3)%0A%3E-%20%20%20%20**%E6%A8%A1%E5%9D%97%E4%B8%AD%E6%96%87%E5%90%8D%3A**%0A%3E%3E%20%20%20%20%20%20%20%E6%A8%A1%E5%9D%97%E8%8B%B1%E6%96%87%E5%90%8D%E5%AF%B9%E5%BA%94%E7%9A%84%E4%B8%AD%E6%96%87%E6%8F%8F%E8%BF%B0%0A%3E-%20%20%20%20**%E6%A8%A1%E5%9D%97%E8%8B%B1%E6%96%87%E5%90%8D%3A**%0A%3E%3E%20%20%20%20%20%20%20%E8%AF%A5%E5%AD%97%E6%AE%B5%E4%B8%BA%E4%BB%A3%E7%A0%81%E4%B8%AD%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%E6%9D%83%E9%99%90%E5%AF%B9%E5%BA%94%E7%9A%84%E5%8F%82%E6%95%B0%EF%BC%8C%E6%90%AD%E9%85%8D%E5%88%86%E9%85%8D%E7%9A%84%E4%B8%8D%E5%90%8C%E6%9D%83%E9%99%90%E7%BB%84%E5%8F%AF%E5%AE%9E%E7%8E%B0%E5%AF%B9%E4%BA%8E%E5%90%8C%E4%B8%80%E6%A8%A1%E5%9D%97%E4%B8%8D%E5%90%8C%E8%A7%92%E8%89%B2%E5%AF%B9%E5%BA%94%E4%B8%8D%E5%90%8C%E7%9A%84%E6%95%B0%E6%8D%AE%E6%9D%83%E9%99%90%0A%3E-%20%20%20%20**%E6%9D%83%E9%99%90sql%3A**%20%20%20%0A%3E%3E%20%20%20%20%20%20%20%E6%9C%80%E7%BB%88%E4%BB%A3%E7%A0%81%E4%B8%AD%E8%8E%B7%E5%BE%97%E5%B9%B6%E6%8B%BC%E6%8E%A5%E5%9C%A8sql%E8%AF%AD%E5%8F%A5%E5%90%8E%E7%9A%84sql%E8%AF%AD%E5%8F%A5(%E5%85%B6%E4%B8%AD%7BallCenterList%7D%E7%AD%89%E4%B8%BAsession%E4%B8%AD%E5%AD%98%E6%94%BE%E7%9A%84%E6%89%80%E6%9C%89%E4%B8%AD%E5%BF%83%E7%9A%84id%E9%9B%86%E5%90%88)%20%20%0A%20%20%20%20%0A%23%23%23%23%20%E4%BB%A3%E7%A0%81%E4%B8%AD%E8%AE%BE%E7%BD%AE%0A%3E-%20**%E4%BD%9C%E4%B8%BAQuery%E5%AF%B9%E8%B1%A1%E4%B8%AD%E7%9A%84%E5%8F%82%E6%95%B0%E4%BC%A0%E5%85%A5**%0A%3E%3E%20%20%20%20%20infoQuery.setAuthSql(MdmAuthorityUtil.getAuthSql(%22%E6%A8%A1%E5%9D%97%E8%8B%B1%E6%96%87%E5%90%8D%22))%3B%0A%3E-%20**%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%E8%AF%B4%E6%98%8E**%0A%3E%3E%201.%E6%9F%A5%E8%AF%A2sql(%E6%A0%B9%E6%8D%AE%E6%9D%83%E9%99%90%E8%8B%B1%E6%96%87%E5%90%8D%E5%92%8C%E7%94%A8%E6%88%B7%E5%AF%B9%E5%BA%94%E7%9A%84%E6%9D%83%E9%99%90%E7%BB%84%E6%9D%A1%E4%BB%B6)%0A%3E%3E%3E%20%20%20%20%20selectAUTH_CODE%2C%0A%3E%3E%3E%20%20%20%20%20AUTH_NAME%2C%20AUTH_SQL%2C%20AUTH_ENG%0A%3E%3E%3E%20%20%20%20%20FROM%20MDM_DATA_AUTH%20%0A%3E%3E%3E%20%20%20%20%20WHERE%20AUTH_STATE%20%3D%201%20AND%20%22ID%22%20IN%20(%0A%3E%3E%3E%20%20%20%20%20%20%20%20%20%20SELECT%20AUTH_ID%20%0A%3E%3E%3E%20%20%20%20%09%09%20FROM%20MDM_AUTH_PG%20%0A%3E%3E%3E%20%20%20%20%09%09%20WHERE%20AUTH_ENG%20%3D%23%7BauthEng%7D%20AND%0A%3E%3E%3E%20%20%20%20%09%09%20AUTH_GROUP_ID%20IN%20(%24%7BpermissionIds%7D)%0A%3E%3E%3E%20%20%20%20%09%09%20GROUP%20BY%20auth_id%20)%20%0A%3E%3E%202.**Sql%E6%8B%BC%E6%8E%A5**%0A%3E%3E%3E%20%20%20%20%20%E5%B0%861%E4%B8%AD%E6%9F%A5%E8%AF%A2%E5%88%B0%E7%9A%84auth_sql%E6%8B%BC%E6%8E%A5%E5%88%B0%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5%E7%9A%84where%E6%9D%A1%E4%BB%B6%E4%B8%AD%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E6%9D%83%E9%99%90%E7%9A%84%E6%8E%A7%E5%88%B6%0A%0A%20%20%20%20%0A%20%0A%20%20%20%20%0A%20%20%20%20%0A</center></span>
</div></body></html> 